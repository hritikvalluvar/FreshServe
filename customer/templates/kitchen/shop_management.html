{% extends "admin/base.html" %}
{% load static %}

{% block content %}
<div style="margin: 0 auto; padding: 20px; max-width: 600px; font-family: Arial, sans-serif;">
    <h1 style="text-align: center; font-size: 2em; margin-bottom: 20px;">Shop Management</h1>

    {% if order_date %}
        <h2 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; color: #4CAF50;">
            Shop is open for {{ order_date|date:"l, j F Y" }}
        </h2>
    {% else %}
        <h2 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; color: #F44336;">
            No Order Date Selected
        </h2>
    {% endif %}

    <!-- Shop Status Indicators -->
    <div style="text-align: center; margin-bottom: 20px;">
        <p>Shop Status: 
            <span style="font-weight: bold; color: {{ shop_open|yesno:'green,red' }};">
                {{ shop_open|yesno:'&#9679; Open,&#9679; Closed' }}
            </span>
        </p>
        <p>Gate Status: 
            <span style="font-weight: bold; color: {{ gate_open|yesno:'green,red' }};">
                {{ gate_open|yesno:'&#9679; Open for Orders,&#9679; Closed for Orders' }}
            </span>
        </p>
    </div>

    <!-- Action Form -->
    <form method="post" style="text-align: center; margin-top: 20px;">
        {% csrf_token %}

        {% if not shop_open and not gate_open %}
            <label for="order-date" style="font-size: 1em; margin-right: 8px;">Select Order Date:</label>
            <input 
                type="date" 
                id="order-date" 
                name="order_date" 
                value="{{ order_date|date:'Y-m-d' }}" 
                required 
                style="padding: 4px; font-size: 1em; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 15px;"
            >
        {% endif %}

        <!-- Action Buttons -->
        <div style="margin-top: 20px;">
            <button 
                type="submit" 
                name="open_shop" 
                id="open-shop-btn" 
                class="action-button" 
                {% if not order_date %}disabled{% endif %}
                style="background-color: #4CAF50; color: white; padding: 8px 16px; border: none; border-radius: 4px; font-size: 1em; cursor: pointer; margin-right: 10px;"
            >
                Open Shop
            </button>

            <button 
                type="submit" 
                name="close_shop" 
                id="close-shop-btn" 
                class="action-button" 
                {% if not shop_open %}disabled{% endif %}
                style="background-color: #F44336; color: white; padding: 8px 16px; border: none; border-radius: 4px; font-size: 1em; cursor: pointer; margin-right: 10px;"
            >
                Close Shop
            </button>

            <button 
                type="submit" 
                name="close_gate" 
                id="close-gate-btn" 
                class="action-button" 
                {% if not gate_open %}disabled{% endif %}
                style="background-color: #FFC107; color: white; padding: 8px 16px; border: none; border-radius: 4px; font-size: 1em; cursor: pointer;"
            >
                Close Gate for Orders
            </button>
        </div>
    </form>
</div>

<script>
    // Enable "Open Shop" button only when a date is selected
    const dateField = document.getElementById("order-date");
    const openShopButton = document.getElementById("open-shop-btn");

    if (dateField) {
        dateField.addEventListener("change", function () {
            openShopButton.disabled = !dateField.value;
        });
    }
</script>

<style>
    /* Style disabled buttons to appear greyed out */
    button:disabled {
        background-color: #ccc !important;
        color: #666 !important;
        cursor: not-allowed !important;
    }

    button.action-button {
        transition: background-color 0.3s ease;
    }

    button.action-button:hover:not(:disabled) {
        filter: brightness(1.1);
    }
</style>
{% endblock %}
